%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% NIMHANS_ANGEL_Analysis_variables
% 
% Purpose: Load default values for variables used in ANGEL ERP Analysis
% Date of Creation: 9 Mar 2015
% Authors: Arun and Ajay
% Last update: 26 May 2015 by Ajay: Added ANGEL.measures
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

clear all;
close all;

%% Investigator and study specific  - needs to be changed as per need.
ANGEL.investigatorID = 'CRL';    % For now, options are 'AKN', 'AS', 'RJ', 'CRL'
ANGEL.acquisitionID = 'EGI';     % Can be Neuroscan also
ANGEL.channelReduction = 'no';

%Set the number of subjects to be sampled per group
ANGEL.sampleSize = 50;

%Set the length of unique part of the filename. 
%Example: AKNLTP001_ANGEL1 has 16 letters that may be followed by _Rare etc
ANGEL.prefixLength = 16;

ANGEL.uiPromptRequired = 'no';

% Set the standard deviations for burst criteria in Clean_Raw plugin
ANGEL.asrBurstCriterion = 5;

% Filter settings
ANGEL.preICALowPass = 40;  % Reduced from 80 for better artifact removal
ANGEL.finalLowPass = 35;   % No longer used

% Sampling rate settings
ANGEL.preICADownSample = 500;
ANGEL.finalDownSample = 250;

% Output directory default options
% outputdir = [matlabroot, '\ANGEL_Analysis'];   
ANGEL.outputDir = 'H:\Ajay\CRLAngelAnalysis_129';
ANGEL.sourceDir = 'H:\Ajay\CRLANGELFunctions';

if ~exist(ANGEL.outputDir, 'dir')
    mkdir(ANGEL.outputDir);
end
ANGEL.rawDir = 'H:\Ajay\CRLAngelAnalysis_129\Raw';
ANGEL.rawEventDir = 'H:\Ajay\CRLAngelAnalysis_129\EventsNS';

%% The following may need to be changed less 
ANGEL.chanLocDir = ANGEL.sourceDir;
ANGEL.chanLocLookupFile = 'Standard-10-5-cap385.elp';

% Set channel location file and matrix
if strcmp(ANGEL.acquisitionID, 'EGI')
    ANGEL.chanLocFile = 'GSN-HydroCel-129.sfp';
    if strcmp(ANGEL.channelReduction, 'no')
        ANGEL.numberofChannels = 129;
        ANGEL.chanLocMat = 'EGIChanLoc129.mat';  
    else
        ANGEL.numberofChannels = 64;
        ANGEL.chanLocMat = 'EGIChanLoc64.mat';                
    end
else
    ANGEL.chanLocFile = 'Standard-10-5-cap385.elp';
    ANGEL.numberofChannels = 64;
    ANGEL.chanLocMat = 'NeuroscanChanLoc.mat';  
end

% EGI 64 channel map corresponding to Neuroscan
ANGEL.egi64ChannelMap = {...
            'nch1 = ch22 label  FP1',...
            'nch2 = ch15 label  FPZ',...
            'nch3 = ch9 label  FP2',...
            'nch4 = ch23 label  AF3',...
            'nch5 = ch3 label  AF4',...
            'nch6 = ch33 label  F7',...
            'nch7 = ch27 label  F5',...
            'nch8 = ch24 label  F3',...
            'nch9 = ch19 label  F1',...
            'nch10 = ch11 label  FZ',...
            'nch11 = ch4 label  F2',...
            'nch12 = ch124 label  F4',...
            'nch13 = ch123 label  F6',...
            'nch14 = ch122 label  F8',...
            'nch15 = ch34 label  FT7',...
            'nch16 = ch28 label  FC5',...
            'nch17 = ch29 label  FC3',...
            'nch18 = ch13 label  FC1',...
            'nch19 = ch6 label  FCZ',...
            'nch20 = ch112 label  FC2',...
            'nch21 = ch111 label  FC4',...
            'nch22 = ch117 label  FC6',...
            'nch23 = ch116 label  FT8',...
            'nch24 = ch45 label  T7',...
            'nch25 = ch41 label  C5',...
            'nch26 = ch36 label  C3',...
            'nch27 = ch30 label  C1',...
            'nch28 = ch129 label  CZ',...
            'nch29 = ch105 label  C2',...
            'nch30 = ch104 label  C4',...
            'nch31 = ch103 label  C6',...
            'nch32 = ch108 label  T8',...
            'nch33 = ch57 label  M1',...
            'nch34 = ch46 label  TP7',...
            'nch35 = ch47 label  CP5',...
            'nch36 = ch42 label  CP3',...
            'nch37 = ch37 label  CP1',...
            'nch38 = ch55 label  CPZ',...
            'nch39 = ch87 label  CP2',...
            'nch40 = ch93 label  CP4',...
            'nch41 = ch98 label  CP6',...
            'nch42 = ch102 label  TP8',...
            'nch43 = ch100 label  M2',...
            'nch44 = ch58 label  P7',...
            'nch45 = ch51 label  P5',...
            'nch46 = ch52 label  P3',...
            'nch47 = ch60 label  P1',...
            'nch48 = ch62 label  PZ',...
            'nch49 = ch85 label  P2',...
            'nch50 = ch92 label  P4',...
            'nch51 = ch97 label  P6',...
            'nch52 = ch96 label  P8',...
            'nch53 = ch65 label  PO7',...
            'nch54 = ch66 label  PO5',...
            'nch55 = ch67 label  PO3',...
            'nch56 = ch72 label  POZ',...
            'nch57 = ch77 label  PO4',...
            'nch58 = ch84 label  PO6',...
            'nch59 = ch90 label  PO8',...
            'nch60 = ch73 label  CB1',...
            'nch61 = ch70 label  O1',...
            'nch62 = ch75 label  OZ',...
            'nch63 = ch83 label  O2',...
            'nch64 = ch88 label  CB2',...
            };

 % EGI 129 channel map corresponding to 10-5 and Neuroscan Nomenclature
ANGEL.egi129ChannelMap = {...
            'ch23	=	ch23	label	AF3',...
            'ch3	=	ch3     label	AF4',...
            'ch26	=	ch26	label	AF7',...
            'ch2	=	ch2     label	AF8',...
            'ch16	=	ch16	label	AFz',...
            'ch30	=	ch30	label	C1',...
            'ch105	=	ch105	label	C2',...
            'ch36	=	ch36	label	C3',...
            'ch104	=	ch104	label	C4',...
            'ch41	=	ch41	label	C5',...
            'ch103	=	ch103	label	C6',...
            'ch73	=	ch73	label	CB1',...
            'ch88	=	ch88	label	CB2',...
            'ch37	=	ch37	label	CP1',...
            'ch87	=	ch87	label	CP2',...
            'ch42	=	ch42	label	CP3',...
            'ch93	=	ch93	label	CP4',...
            'ch47	=	ch47	label	CP5',...
            'ch98	=	ch98	label	CP6',...
            'ch55	=	ch55	label	CPz',...
            'ch129	=	ch129	label	Cz',...
            'ch19	=	ch19	label	F1',...
            'ch1	=	ch1     label	F10',...
            'ch4	=	ch4     label	F2',...
            'ch24	=	ch24	label	F3',...
            'ch124	=	ch124	label	F4',...
            'ch27	=	ch27	label	F5',...
            'ch123	=	ch123	label	F6',...
            'ch33	=	ch33	label	F7',...
            'ch122	=	ch122	label	F8',...
            'ch32	=	ch32	label	F9',...
            'ch13	=	ch13	label	FC1',...
            'ch112	=	ch112	label	FC2',...
            'ch29	=	ch29	label	FC3',...
            'ch111	=	ch111	label	FC4',...
            'ch28	=	ch28	label	FC5',...
            'ch117	=	ch117	label	FC6',...
            'ch6	=	ch6     label	FCz',...
            'ch22	=	ch22	label	FP1',...
            'ch9	=	ch9   	label	FP2',...
            'ch15	=	ch15	label	FPz',...
            'ch121	=	ch121	label	FT10',...
            'ch34	=	ch34	label	FT7',...
            'ch116	=	ch116	label	FT8',...
            'ch38	=	ch38	label	FT9',...
            'ch11	=	ch11	label	Fz',...
            'ch57	=	ch57	label	M1',...
            'ch100	=	ch100	label	M2',...
            'ch70	=	ch70	label	O1',...
            'ch83	=	ch83	label	O2',...
            'ch75	=	ch75	label	Oz',...
            'ch60	=	ch60	label	P1',...
            'ch95	=	ch95	label	P10',...
            'ch85	=	ch85	label	P2',...
            'ch52	=	ch52	label	P3',...
            'ch92	=	ch92	label	P4',...
            'ch51	=	ch51	label	P5',...
            'ch97	=	ch97	label	P6',...
            'ch58	=	ch58    label	P7',...
            'ch96	=	ch96	label	P8',...
            'ch64	=	ch64	label	P9',...
            'ch67	=	ch67	label	PO3',...
            'ch77	=	ch77	label	PO4',...
            'ch66	=	ch66	label	PO5',...
            'ch84	=	ch84	label	PO6',...
            'ch65	=	ch65	label	PO7',...
            'ch90	=	ch90	label	PO8',...
            'ch72	=	ch72	label	POz',...
            'ch62	=	ch62	label	Pz',...
            'ch114	=	ch114	label	T10',...
            'ch45	=	ch45	label	T7',...
            'ch108	=	ch108	label	T8',...
            'ch44	=	ch44	label	T9',...
            'ch46	=	ch46	label	TP7',...
            'ch102	=	ch102	label	TP8',...
            };      
        

% If it is Neuroscan, remove these channels before EEG processing
ANGEL.channelsForExclusion = {'HEO' 'VEO' 'EKG' 'EMG'};

ANGEL.gameList = {...
    'ANGEL1',...
    'ANGEL2',...
    'ANGEL3',...
    };

ANGEL.erpLabels = {...
    'P300',...
    'ERN',...
    'N170',...
    'CD',...
    'N2pc',...
    'LRP',...
    'MMN',...
    'P50',...
    'C1',...
    };

ANGEL.erpEventLabels = {...
    'FrequentImage',...  % P300
    'RareImage',...      % P300
    'Correct',...        % ERN
    'Incorrect',...      % ERN
    'FacePresent',...    % N170
    'FaceAbsent',...     % N170
    'ShapePresent',...   % N170
    'ShapeAbsent',...    % N170
    'BaselineImage',...  % N170
    'CDOn',...           % CD
    'CDOff',...          % CD
    'ButtonPress',...    % CD
    'LeftImage',...       % N2PC
    'RightImage',...      % N2PC
    'LeftPress',...       % LRP
    'RightPress',...      % LRP
    'StandardToneS1',... % P50 and MMN
    'StandardToneS2',... % P50
    'DeviantToneS1',...  % MMN
    'DeviantToneS2',...  % P50/MMN?
    'BlankToneS1',...    % P50 and MMN
    'Top',...             % C1
    'Bottom',...          % C1
    };

%% Event clusters to be used for ERP analysis
ANGEL.erpEventLabelClusters = {...
    {'FrequentImage','RareImage'},...                       % P300
    {'Correct','Incorrect'},...                             % ERN
    {'FacePresent','FaceAbsent','ShapePresent','ShapeAbsent','BaselineImage'},...   % N170
    {'CDOn','CDOff','ButtonPress'},...                      % CD
    {'LeftImage','RightImage'},...                          % N2pc
    {'LeftPress','RightPress'},...                          % LRP
    {'StandardToneS1','DeviantToneS1','BlankToneS1'},...    % MMN
    {'StandardToneS1','StandardToneS2','BlankToneS1'},...   % P50
    {'Top','Bottom'},...                                    % C1
    };

ANGEL.measures = {...
    'ERP',...
    'ERSP',...
    'ITC',...
    'Spec',...
    };


switch ANGEL.investigatorID
    case 'AS'
        ANGEL.paradigmID = 'AS';
        ANGEL.groupList = {'SCZ', 'CNT'};
    case 'RJ'
        ANGEL.paradigmID = 'VI';      
        ANGEL.groupList = {'Tea', 'Sen', 'Nov', 'NON'};
    case 'AKN'
        ANGEL.paradigmID = 'RY';      
        ANGEL.groupList = {'LTP', 'STP', 'Non'};
    case 'CRL'
        ANGEL.paradigmID = 'CRL';      
        %ANGEL.groupList = {'CON', 'LTM', 'LTP', 'SCZ'};        % For
        %Spectrum paper
        
        %For methodology paper
        ANGEL.groupList = {'Non'};        
end

ANGEL.continuousFileEventLabels = {'StimProbe'};
ANGEL.continuousEventMarkers = {...
    {36;44;52;60;84;92;116;124;148;156;180;188;38;46;54;62;86;94;118;126;...
    150;158;182;190;32;40;48;56;80;88;112;120;144;152;176;184;34;42;50;58;...
    82;90;114;122;146;154;178;186;37;45;53;61;85;93;117;125;149;157;181;...
    189;39;47;55;63;87;95;119;127;151;159;183;191;33;41;49;57;81;89;113;...
    121;145;153;177;185;35;43;51;59;83;91;115;123;147;155;179;187}...
    };

%% Event list values for S1 for P50 and MMN as well as blank 

% FullS1EventList = {220,221,222,235,223,224,225};
ANGEL.S1EventList = {221,222,224,225};

%% Event list values for S2 for P50 and MMN as well as blank 

% FullS2EventList = {210,211,212,205,213,214,215};
ANGEL.S2EventList = {211,212,214,215};

ANGEL.erpEventMarkers = {...
    {[32;34;36;38;40;42;44;46;48;50;...
        52;54;56;58;60;62;80;82;84;86;...
        88;90;92;94;112;114;116;118;120;122;...
        124;126;144;146;148;150;152;154;156;158;...
        176;178;180;182;184;186;188;190]},...       % FrequentImage    
    {[33;35;37;39;41;43;45;47;49;51;...
        53;55;57;59;61;63;81;83;85;87;...
        89;91;93;95;113;115;117;119;121;123;...
        125;127;145;147;149;151;153;155;157;159;...
        177;179;181;183;185;187;189;191]},...       % RareImage        
    {[32;33;34;35;36;37;38;39;48;49;...
        50;51;52;53;54;55;80;81;82;83;...
        84;85;86;87;112;113;114;115;116;117;...
        118;119;...                                                   % Correct: Left side - Button 1 
        144;145;148;149;154;155;158;159;176;177;...
        180;181;186;187;190;191],...                      % Correct: Present - Button 1
        [40;41;42;43;44;45;46;47;56;57;...
        58;59;60;61;62;63;88;89;90;91;...
        92;93;94;95;120;121;122;123;124;125;...
        126;127;...                                                   % Correct: Right side - Button 2          
        146;147;150;151;152;153;156;157;178;...
        179;182;183;184;185;188;189]},...              % Correct: Present - Button 2        
    {[40;41;42;43;44;45;46;47;56;57;...
        58;59;60;61;62;63;88;89;90;91;...
        92;93;94;95;120;121;122;123;124;125;...
        126;127;...                                                   % Incorrect: Right side - Button 1         
        146;147;150;151;152;153;156;157;178;...
        179;182;183;184;185;188;189],...               % Incorrect: Present - Button 1 
        [32;33;34;35;36;37;38;39;48;49;...
        50;51;52;53;54;55;80;81;82;83;...
        84;85;86;87;112;113;114;115;116;117;...
        118;119;...                                                   % Incorrect: Left side - Button 2 
        144;145;148;149;154;155;158;159;176;177;...
        180;181;186;187;190;191]},...                     % Incorrect: Present - Button 2           
    {[36;37;44;45;52;53;60;61;84;85;...
        92;93;116;117;124;125;148;149;156;157;...
        180;181;188;189]},...                                   % FacePresent
    {[38;39;46;47;54;55;62;63;86;87;...
        94;95;118;119;126;127;150;151;158;159;...
        182;183;190;191]},...                                   % FaceAbsent
    {[32;33;40;41;48;49;56;57;80;81;...
        88;89;112;113;120;121;144;145;152;153;...
        176;177;184;185]},...                                   % ShapePresent
    {[34;35;42;43;50;51;58;59;82;83;...
        90;91;114;115;122;123;146;147;154;155;...
        178;179;186;187]},...                                   % ShapeAbsent
    {250},...                                                            % BaselineImage
    {246},...                                                            % CDOn
    {247},...                                                            % CDOff
    {[01;02]},...                                                   % ButtonResponse
    {[32;33;34;35;36;37;38;39;48;49;...
    50;51;52;53;54;55;80;81;82;83;...
    84;85;86;87;112;113;114;115;116;117;...
    118;119;...                                                   
    144;145;146;147;148;149;150;151;176;177;...
    178;179;180;181;182;183]},...                         % Image comes on left 
    {[40;41;42;43;44;45;46;47;56;57;...
    58;59;60;61;62;63;88;89;90;91;...
    92;93;94;95;120;121;122;123;124;125;...
    126;127;...                                                          
    152;153;154;155;156;157;158;159;184;...
    185;186;187;188;189;190;191]},...                  % Image comes on right      
    {[32;33;34;35;36;37;38;39;48;49;...
    50;51;52;53;54;55;80;81;82;83;...
    84;85;86;87;112;113;114;115;116;117;...
    118;119;...                                                   
    144;145;148;149;154;155;158;159;176;177;...
    180;181;186;187;190;191]},...                         % Left to be pressed  
    {[40;41;42;43;44;45;46;47;56;57;...
    58;59;60;61;62;63;88;89;90;91;...
    92;93;94;95;120;121;122;123;124;125;...
    126;127;...                                                          
    146;147;150;151;152;153;156;157;178;...
    179;182;183;184;185;188;189]},...                  % Right to be pressed      
    {[220;221;222]},...                                            % StandardToneS1
    {[210;211;212]},...                                            % StandardToneS2
    {[223;224;225]},...                                            % DeviantToneS1
    {[213;214;215]},...                                            % DeviantToneS2
    {235},...                                                            % BlankToneS1
    {253},...                                                            % Top
    {254},...                                                            % Bottom
    };

ANGEL.icaEpochs = [-.5 .8];     %  In seconds
ANGEL.eegEpochs = [-1 2];       %  In seconds
ANGEL.erpBaselineCorrection = [-200 0];  %  In milliseconds
ANGEL.erpEpochs = [-1000 2000];          %  In milliseconds

ANGEL.progressBarPosition = [465, 400, 270, 80];

%Default File Name Separator
ANGEL.sep = '_';

% Save all the variables
save([ANGEL.sourceDir, '\ANGELVariables.mat']);

msgbox(['Completed creation of ANGEL Variables'], 'Message', 'help');